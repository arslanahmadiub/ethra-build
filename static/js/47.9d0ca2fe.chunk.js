(window.webpackJsonp=window.webpackJsonp||[]).push([[47],{659:function(e,a,t){},753:function(e,a,t){"use strict";t.d(a,"a",function(){return d});var n=t(30),r=t(31),l=t(33),c=t(32),s=t(34),o=t(0),m=t.n(o),i=t(564),u=t(266),d=function(e){function a(){return Object(n.a)(this,a),Object(l.a)(this,Object(c.a)(a).apply(this,arguments))}return Object(s.a)(a,e),Object(r.a)(a,[{key:"render",value:function(){var e=this.props,a=e.isOpen,t=e.toggle,n=e.handle,r=e.type;return m.a.createElement(i.a,{className:"modal-dialog-centered",isOpen:a,toggle:t},m.a.createElement("div",{className:"modal-header"},m.a.createElement("h6",{className:"modal-title",id:"modal-title-default"},"Confirm delete ".concat(r,"!")),m.a.createElement("button",{"aria-label":"Close",className:"close","data-dismiss":"modal",type:"button",onClick:t},m.a.createElement("span",{"aria-hidden":!0},"\xd7"))),m.a.createElement("div",{className:"modal-body"},m.a.createElement("p",null,"Do you want to delete this ".concat(r,"?"))),m.a.createElement("div",{className:"modal-footer"},m.a.createElement(u.a,{color:"danger",type:"button",onClick:n},"Delete"),m.a.createElement(u.a,{className:"ml-auto",color:"link","data-dismiss":"modal",type:"button",onClick:t},"Close")))}}]),a}(m.a.Component)},981:function(e,a,t){"use strict";t.r(a);var n=t(2),r=t.n(n),l=t(7),c=t(5),s=t(53),o=t(37),m=t(30),i=t(31),u=t(33),d=t(32),p=t(34),h=t(0),E=t.n(h),f=t(45),g=t(48),b=t(569),v=t.n(b),N=t(44),y=t.n(N),k=t(8),C=t(634),D=t.n(C),w=t(536),O=t(554),j=t(568),F=t(560),V=t(561),S=t(538),x=t(539),_=t(562),M=t(563),H=t(556),I=t(266),T=t(597),R=t(18),B=t(104),P=t(46),U=t(99),z=t(753),J=(t(659),["monday","tuesday","wednesday","thursday","friday","saturday","sunday"]),Y=J.map(function(e,a){return{dayOfWeek:a+1,name:e,startTime:"8:00",closeTime:"20:00",isUsable:!1}}),A=function(e){function a(e){var t;return Object(m.a)(this,a),(t=Object(u.a)(this,Object(d.a)(a).call(this,e))).deleleVenue=function(){var e=t.props.match.params.venueId;P.a.delete(e).then(function(){k.b.success("Delete venue successfully"),t.props.history.push("/admin/venues")}).catch(function(){k.b.error("Delete venue failed")})},t.toggleConfirmDelete=function(){t.setState({isDeleteVenue:!t.state.isDeleteVenue})},t.addBlackoutDates=function(e){t.setState({blackoutDates:[{date:null}].concat(Object(o.a)(t.state.blackoutDates))})},t.setBlackoutDates=function(e,a){var n=new Date(e._d+""),r=t.state.blackoutDates;r[a]={date:Object(R.f)(n)},t.setState({blackoutDates:r})},t.deleteBlackoutDates=function(e){var a=t.state.blackoutDates;a.splice(e,1),t.setState({blackoutDates:a})},t.blackoutDateValidate=function(e){var a=t.state.blackoutDates,n=!1;return a.forEach(function(a){n=n||Object(R.f)(e)===a.date}),Object(R.z)(e)&&!n},t.handleChange=function(e){var a=e.target,n=a.name,r=a.value;delete t.state.errors[n],t.setState(Object(s.a)({},n,r))},t.handleChangeTime=function(e,a,n){var r=new Date(e._d+"");"closeTime"===n&&0===r.getHours()&&0===r.getMinutes()&&(r.setHours(23),r.setMinutes(59));var l=t.state.operatingHours;l[a][n]=Object(R.u)(r,"HH:mm"),t.setState({operatingHours:l})},t.handleCheckTime=function(e){var a=t.state.operatingHours,n=e.target,r=n.name,l=n.checked;a[Number(r)].isUsable=l,t.setState({operatingHours:a})},t.handleFile=function(e){var a=e.target,n=a.name,r=a.files;r.length&&t.setState(Object(s.a)({},n,r[0]))},t.handleError=function(e,a){var n,r=!0;if(a)for(var l in t.state.isFormReady)r=r&&t.state.isFormReady[l];t.setState({isFormReady:Object(c.a)({},t.state.isFormReady,(n={},Object(s.a)(n,e,a),Object(s.a)(n,"check",r&&a),n))})},t.saveForm=function(e){e.preventDefault();var a=t.props.match.params.venueId,n=t.state;y.a.isString(n.image)&&delete n.image,y.a.isString(n.roomMap)&&delete n.roomMap;var r=new FormData;Object.keys(n).forEach(function(e){Array.isArray(t.state[e])?r.append([e],JSON.stringify(t.state[e])):r.append([e],t.state[e])});var l,c,s=null;a?(s=P.a.update({formData:r,venueId:a}),l="Update venue successfully",c="Update venue failed"):(s=P.a.create(r),l="Create venue successfully",c="Create venue failed"),s.then(function(e){k.b.success(l),a||t.props.history.push("/admin/venues/".concat(e.id))}).catch(function(e){var a=e.response.data;t.setState({errors:a}),k.b.error(c)})},t.state={name:null,image:null,roomMap:null,address:null,phoneNumber:null,email:null,contactPerson:null,operatingHours:Y,blackoutDates:[],errors:{},isFormReady:{},isDeleteVenue:!1},t}return Object(p.a)(a,e),Object(i.a)(a,[{key:"getVenueId",value:function(){return this.props.match.params.venueId}},{key:"drawSVG",value:function(){var e=Object(l.a)(r.a.mark(function e(a,t){var n,l,c,s,o,m,i,u,d,p=this;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=document.getElementById("room-map-wrapper"),e.next=3,Object(R.n)(a);case 3:l=e.sent,c=l.width,s=l.height,o=n?n.clientWidth:500,m=Object(R.a)(s/c*o,4),i=o/c,u=m/s,(d=D()("svg-drawing").size(o,m)).image(a,o,m);try{JSON.parse(t).forEach(function(e){var a,t;t=d.link("#/admin/venues/".concat(p.getVenueId(),"/spaces/").concat(e.id));var n=e.coords;switch(e.shape){case"poly":a=[];for(var r=0;r<n.length;r+=2){var l=[n[r]*i,n[r+1]*u];a.push(l)}t.polyline(a);break;case"rect":var c=(n[2]-n[0])*i,s=(n[3]-n[1])*u;t.rect(c,s).attr({x:n[0]*i,y:n[1]*u})}t.attr({fill:"transparent"}).mouseover(function(){this.fill({color:"rgba(0,0,0,0.5)"})}).mouseout(function(){this.fill({color:"transparent"})})})}catch(r){}case 13:case"end":return e.stop()}},e)}));return function(a,t){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var e=this,a=this.props.match.params.venueId;a&&P.a.detail(a).then(function(a){var t=a.name,n=a.image,r=a.roomMap,l=a.roomMapMapping,c=a.address,s=a.phoneNumber,o=a.email,m=a.contactPerson,i=a.operatingHours,u=a.blackoutDates,d=i.map(function(e,a){return e.name=J[a],e});r&&l&&l.length&&e.drawSVG(r,l),e.setState({name:t,image:n,roomMap:r,address:c,phoneNumber:s,email:o,contactPerson:m,operatingHours:d,blackoutDates:u})})}},{key:"render",value:function(){var e=this,a=this.state,t=a.name,n=a.email,r=a.address,l=a.contactPerson,c=a.phoneNumber,s=a.blackoutDates,o=a.image,m=a.operatingHours,i=a.roomMap,u=a.errors,d=a.isFormReady,p=(t&&n&&o&&i&&!y.a.isEmpty(s)&&!y.a.isEmpty(m)&&d.check,this.props.match.params.venueId);return E.a.createElement(E.a.Fragment,null,E.a.createElement(z.a,{className:"modal-dialog-centered",isOpen:this.state.isDeleteVenue,toggle:this.toggleConfirmDelete,handle:this.deleleVenue,type:"Vanue"}),E.a.createElement(w.a,{className:"venues mt--12",fluid:!0},E.a.createElement(O.a,{className:"mb-4"},E.a.createElement(j.a,null,E.a.createElement("h3",{className:"mb-0"},"Create Venue")),E.a.createElement(F.a,null,E.a.createElement(V.a,{onSubmit:this.saveForm},E.a.createElement(S.a,null,E.a.createElement(x.a,{md:"6"},E.a.createElement(_.a,{className:"row"},E.a.createElement(M.a,{className:"form-control-label",md:"3"},"Venue Name"),E.a.createElement(x.a,{md:"7"},E.a.createElement(B.a,{required:!0,type:"text",name:"name",defaultValue:t,handleError:this.handleError,errors:u.name,onChange:this.handleChange}))),E.a.createElement(_.a,{className:"row"},E.a.createElement(M.a,{className:"form-control-label",md:"3"},"Image"),E.a.createElement(x.a,{md:"7"},E.a.createElement(O.a,{className:"align-items-center"},o?E.a.createElement(H.a,{alt:"...",src:y.a.isObject(o)?URL.createObjectURL(o):o,top:!0}):E.a.createElement("div",{className:"venues__placeholder-image",onClick:function(){return e.openImageFile.click()}},E.a.createElement("div",{className:"venues__placeholder-image__label"},"No Image")),E.a.createElement("input",{ref:function(a){return e.openImageFile=a},onChange:this.handleFile,style:{display:"none"},type:"file",name:"image",id:"roomImage",accept:".jpg,.gif,.jpeg,.png"}),E.a.createElement(I.a,{className:"mt-3 w-30",color:"default",onClick:function(){return e.openImageFile.click()}},"Select Image"),E.a.createElement("div",{className:"error-text mt-3"},u.image)))),E.a.createElement(_.a,{className:"row"},E.a.createElement(M.a,{className:"form-control-label",md:"3"},"Room Map"),E.a.createElement(x.a,{md:"7",id:"room-map-wrapper",className:"p-0"},this.getVenueId()?E.a.createElement("div",{id:"svg-drawing"}):E.a.createElement(O.a,{className:"align-items-center"},E.a.createElement("input",{ref:function(a){return e.openMapFile=a},onChange:this.handleFile,style:{display:"none"},type:"file",name:"roomMap",id:"roomMap",accept:".zip"}),E.a.createElement("div",{className:"d-flex w-100 justify-content-between align-items-center"},E.a.createElement("div",{className:"nav-link",style:{fontSize:".85rem"}},i&&i.name?i.name:"No room map zip file!"),E.a.createElement(I.a,{color:"default",onClick:function(){return e.openMapFile.click()}},"Select Mapping")),u&&u.roomMap&&E.a.createElement("div",{className:"error-text mt-3"},u.roomMap))))),E.a.createElement(x.a,{md:"6"},E.a.createElement(_.a,{className:"row"},E.a.createElement(M.a,{className:"form-control-label",md:"3"},"Address"),E.a.createElement(x.a,{md:"7"},E.a.createElement(B.a,{type:"text",name:"address",defaultValue:r,handleError:this.handleError,errors:u.address,onChange:this.handleChange}))),E.a.createElement(_.a,{className:"row"},E.a.createElement(M.a,{className:"form-control-label",htmlFor:"example-search-input",md:"3"},"Tel"),E.a.createElement(x.a,{md:"7"},E.a.createElement(B.a,{type:"text",name:"phoneNumber",defaultValue:c,handleError:this.handleError,errors:u.phoneNumber,onChange:this.handleChange,regex:"phoneNumber"}))),E.a.createElement(_.a,{className:"row"},E.a.createElement(M.a,{className:"form-control-label",htmlFor:"example-email-input",md:"3"},"E-mail"),E.a.createElement(x.a,{md:"7"},E.a.createElement(B.a,{required:!0,type:"email",name:"email",defaultValue:n,handleError:this.handleError,errors:u.email,onChange:this.handleChange,regex:"email"}))),E.a.createElement(_.a,{className:"row"},E.a.createElement(M.a,{className:"form-control-label",htmlFor:"example-password-input",md:"3"},"Contact person"),E.a.createElement(x.a,{md:"7"},E.a.createElement(B.a,{type:"text",name:"contactPerson",defaultValue:l,handleError:this.handleError,errors:u.contactPerson,onChange:this.handleChange}))),E.a.createElement(_.a,{className:"row"},E.a.createElement(M.a,{className:"form-control-label",htmlFor:"example-password-input",md:"12",lg:"3"},"Operating Hours"),E.a.createElement(x.a,{className:"venues__openrating-hours",md:"12",lg:"7"},E.a.createElement(T.a,{className:"venues__table-openrating-hours w-100"},E.a.createElement("thead",null,E.a.createElement("tr",null,E.a.createElement("th",{width:"50%"}),E.a.createElement("th",{width:"25%"},"Open"),E.a.createElement("th",{width:"25%"},"Close"))),E.a.createElement("tbody",null,m.map(function(a,t){return E.a.createElement("tr",{key:t},E.a.createElement("td",null,E.a.createElement("div",{className:"custom-control custom-checkbox"},E.a.createElement("input",{className:"custom-control-input",id:a.name,name:t,type:"checkbox",checked:a.isUsable,onChange:e.handleCheckTime}),E.a.createElement("label",{className:"custom-control-label text-capitalize",htmlFor:a.name},a.name))),E.a.createElement("td",null,E.a.createElement(v.a,{className:"venues__select-time",value:Object(R.p)(a.startTime,"HH:mm"),timeFormat:!0,dateFormat:!1,closeOnSelect:!0,onChange:function(a){return e.handleChangeTime(a,t,"startTime")}})),E.a.createElement("td",null,E.a.createElement(v.a,{className:"venues__select-time",value:Object(R.p)(a.closeTime,"HH:mm"),closeOnSelect:!0,timeFormat:!0,dateFormat:!1,onChange:function(a){return e.handleChangeTime(a,t,"closeTime")}})))}))),E.a.createElement("div",{className:"error-text mt-3"},u.operatingHours))),E.a.createElement(_.a,{className:"row mt-5"},E.a.createElement(M.a,{className:"form-control-label",htmlFor:"example-password-input",md:"3"},"Blackout Dates"),E.a.createElement(x.a,{md:"7",className:"venues__blackout-date ".concat(s.length>4?"venues__blackout-date--scroll":"")},E.a.createElement(S.a,{className:"mb-3"},E.a.createElement(x.a,{lg:"6"},E.a.createElement(I.a,{className:"w-5",color:"secondary",onClick:this.addBlackoutDates},"+"))),E.a.createElement("div",{className:"venues__blackout-date-section"},s.map(function(a,t){return E.a.createElement(S.a,{key:t,className:"mb-2"},E.a.createElement(x.a,{lg:"6",sm:"8",xs:"8"},E.a.createElement(v.a,{inputProps:{placeholder:"Date Picker"},closeOnSelect:!0,timeFormat:!1,dateFormat:!0,value:Object(R.p)(a.date,"YYYY:MM:DD"),onChange:function(a){return e.setBlackoutDates(a,t)},isValidDate:e.blackoutDateValidate})),E.a.createElement(x.a,{md:"2",xs:"2"},E.a.createElement(I.a,{className:"w-5",color:"secondary",onClick:function(){return e.deleteBlackoutDates(t)}},"\u2212")))})),E.a.createElement("div",{className:"error-text mt-3"},u.blackoutDates))))),E.a.createElement(S.a,null,E.a.createElement(x.a,{md:"6",className:"mb-3"},p&&E.a.createElement(I.a,{color:"danger",onClick:this.toggleConfirmDelete},"Delete Venue")),E.a.createElement(x.a,{md:"6",className:"mb-3"},E.a.createElement(g.b,{to:"/admin/venues",className:"mr-3"},E.a.createElement(I.a,{color:"secondary"},"Cancel")),E.a.createElement(I.a,{color:"success",onClick:this.saveForm,disabled:!1},this.getVenueId()?"Save Changes":"Create Venue"))))))))}}]),a}(E.a.Component),q={removeVenue:U.c};a.default=Object(f.b)(null,q)(A)}}]);
//# sourceMappingURL=47.9d0ca2fe.chunk.js.map